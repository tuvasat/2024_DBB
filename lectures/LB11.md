# Урок 10 SQL: Запросы с агрегатами (пункт 1)

В дополнение к простым выражениям, которые мы представили на прошлом уроке, SQL также поддерживает использование агрегированных выражений (или функций), которые позволяют обобщать информацию о группе строк данных. В базе данных Pixar, которую вы используете, агрегатные функции можно использовать для ответов на такие вопросы, как "Сколько фильмов выпустила Pixar?" Или "Какой фильм Pixar является самым кассовым за год?".

Выберите запрос с агрегатными функциями по всем строкам
``` sql
SELECT AGG_FUNC(_column_or_expression_) AS aggregate_description, … 
FROM mytable 
WHERE _constraint_expression_;
```
Без заданной группировки каждая агрегатная функция будет выполняться со всем набором результирующих строк и возвращать единственное значение. Как и в случае с обычными выражениями, присвоение вашим агрегатным функциям псевдонима гарантирует, что результаты будут легче считываться и обрабатываться.

# Общие агрегатные функции

Вот несколько распространенных агрегатных функций, которые мы собираемся использовать в наших примерах:
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
ТАБЛИЦА...
Функция

Описание

**COUNT(*****)**,  **COUNT(**столбец**)**

Обычная функция, используемая для подсчета количества строк в группе, если имя столбца не указано. В противном случае подсчитайте количество строк в группе с ненулевыми значениями в указанном столбце.

**MIN(**столбец**)**

Находит наименьшее числовое значение в указанном столбце для всех строк в группе.

**МАКСИМАЛЬНОЕ значение (**столбец**)**

Находит наибольшее числовое значение в указанном столбце для всех строк в группе.

**Среднее значение столбца**()

Находит среднее числовое значение в указанном столбце для всех строк в группе.

**СУММА (**столбец**)**

Находит сумму всех числовых значений в указанном столбце для строк в группе.

Документы:  [MySQL](https://dev.mysql.com/doc/refman/5.6/en/group-by-functions.html "Агрегатные функции MySQL"),  [Postgres](http://www.postgresql.org/docs/9.4/static/functions-aggregate.html "Агрегатные функции Postgres"),  [SQLite](http://www.sqlite.org/lang_aggfunc.html "Агрегатные функции SQLite"),  [Microsoft SQL Server](https://msdn.microsoft.com/en-us/library/ms173454.aspx "Агрегатные функции Microsoft SQL Server")
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#
# Сгруппированные агрегатные функции

В дополнение к агрегированию по всем строкам, вы можете вместо этого применить агрегатные функции к отдельным группам данных внутри этой группы (например, кассовые сборы комедий или боевиков).  
Затем это приведет к созданию такого количества результатов, сколько уникальных групп определено в  `GROUP BY`  предложении.

Выберите запрос с агрегатными функциями вместо групп
``` sql
SELECT AGG_FUNC(_column_or_expression_) AS aggregate_description, … 
FROM mytable 
WHERE _constraint_expression_  
GROUP BY column;
```
Предложение  `GROUP BY`  работает путем группировки строк, имеющих одинаковое значение в указанном столбце.

# Упражнение

В этом упражнении мы будем работать с нашей таблицей  **Employees**. Обратите внимание, что строки в этой таблице содержат общие данные, что даст нам возможность использовать агрегатные функции для суммирования некоторых высокоуровневых показателей о командах. Давайте попробуем.
## Упражнение 10 —  Задачи

1.  Определите, как долго сотрудник проработал в студии
2.  Для каждой роли найдите среднее количество лет, отработанных сотрудниками на этой роли
3.  Найдите общее количество лет работы сотрудников в каждом здании