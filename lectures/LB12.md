# Урок 11 SQL: Запросы с агрегатами (пункт 2 ) 2)

Наши запросы становятся довольно сложными, но мы почти представили все важные части  `SELECT`  запроса. Одна вещь, которую вы, возможно, заметили, заключается в том, что если  `GROUP BY`  предложение выполняется после  `WHERE`  предложения (которое фильтрует строки, которые должны быть сгруппированы), то как именно мы фильтруем сгруппированные строки?

К счастью, SQL позволяет нам делать это, добавляя дополнительное  `HAVING`  предложение, которое используется специально с  `GROUP BY`  предложением, чтобы позволить нам фильтровать сгруппированные строки из результирующего набора.

Выберите запрос с ограничением
``` sql
SELECT group_by_column, AGG_FUNC(_column_expression_) AS aggregate_result_alias, … 
FROM mytable 
WHERE _condition_ GROUP BY column 
HAVING _group_condition_;
```
`HAVING`  Ограничения предложения записываются так же, как и  `WHERE`  ограничения предложения, и применяются к сгруппированным строкам. На наших примерах это может показаться не особенно полезной конструкцией, но если вы представляете данные с миллионами строк с различными свойствами, часто бывает необходимо применять дополнительные ограничения, чтобы быстро разобраться в данных.

>Знаете ли вы?

>Если вы не используете предложение `GROUP BY`, будет достаточно простого предложения `WHERE`.

# Упражнение

В этом упражнении вы углубитесь в данные о  **сотрудниках**  киностудии. Подумайте о различных положениях, которые вы хотите применить для каждой задачи.
## Упражнение 11 —  Задачи

1.  Найдите количество исполнителей в студии (без предложения  **HAVING**)
2.  Найдите количество сотрудников каждой роли в студии
3.  Найдите общее количество лет работы всех инженеров